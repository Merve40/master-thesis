(this.webpackJsonpdidm=this.webpackJsonpdidm||[]).push([[0],{233:function(e,t,n){},256:function(e,t){},257:function(e,t){},280:function(e,t){},282:function(e,t){},291:function(e,t){},293:function(e,t){},319:function(e,t){},321:function(e,t){},326:function(e,t){},328:function(e,t){},340:function(e,t){},343:function(e,t){},364:function(e,t){},372:function(e,t){},390:function(e,t){},392:function(e,t){},407:function(e,t){},408:function(e,t){},462:function(e,t){},473:function(e,t){},476:function(e,t){},530:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(58),s=n.n(c),i=(n(233),n(79)),o=n(47),u=n(13),l=function(){return Object(u.jsx)("header",{children:Object(u.jsx)(i.a,{className:"p-3",style:{backgroundColor:"blue",color:"ivory"},children:Object(u.jsxs)(o.a,{children:[" ",Object(u.jsx)("h1",{children:"Decentralized Identity Management "}),"  "]})})})},d=n(21),j=n.n(d),p=n(70),b=n(48),h=n(40),f=n(221),x=n(81),O=n(222),m=n(226),v=n(223),y=n(220),g=n.n(y),k="http://192.168.178.24:8080";function w(e,t,n){return C.apply(this,arguments)}function C(){return(C=Object(p.a)(j.a.mark((function e(t,n,r){var a,c,s,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=t.eth.accounts.privateKeyToAccount(n),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",[!1,"Invalid private key"]);case 7:return e.next=9,fetch("".concat(k,"/challenge/").concat(a.address),{method:"get",mode:"cors",headers:{"Content-Type":"application/json"}});case 9:return c=e.sent,e.next=12,c.json();case 12:if(s=e.sent,500!=c.status){e.next=15;break}return e.abrupt("return",[!1,s.error]);case 15:return e.next=17,N(t,a,s.nonce);case 17:return i=e.sent,e.next=20,fetch("".concat(k,"/authenticate?address=").concat(a.address,"&broker=").concat(r,"&signature=").concat(i),{method:"get",mode:"cors",headers:{"Content-Type":"application/json"}});case 20:return c=e.sent,e.next=23,c.json();case 23:if(s=e.sent,500!=c.status){e.next=26;break}return e.abrupt("return",[!1,s.error]);case 26:return s.address=a.address,e.abrupt("return",[!0,s]);case 28:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function S(e,t,n){var r="";if(n){var a=new Date;a.setTime(n),r="; expires="+a.toUTCString()}document.cookie=e+"="+(t||"")+r+"; SameSite=Lax; path=/"}function N(e,t,n){return T.apply(this,arguments)}function T(){return(T=Object(p.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.eth.accounts.hashMessage(r),e.next=3,n.sign(a).signature;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=function(e){var t=e.web3,n=Object(r.useState)(!1),a=Object(b.a)(n,2),c=a[0],s=a[1],l=Object(r.useState)(!1),d=Object(b.a)(l,2),y=d[0],k=d[1],C=Object(r.useState)(null),N=Object(b.a)(C,2),T=N[0],L=N[1],P=Object(r.useState)(null),D=Object(b.a)(P,2),F=D[0],I=D[1],A=Object(r.useState)(null),B=Object(b.a)(A,2),J=B[0],K=B[1];function M(){return(M=Object(p.a)(j.a.mark((function e(){var n,r,a,c,i,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(!0),""!==F.trim()&&""!==J.trim()){e.next=3;break}return e.abrupt("return");case 3:return n=F,F.startsWith("0x")||(n="0x"+F),r=J+".eth",e.next=8,w(t,n,r);case 8:if(a=e.sent,c=Object(b.a)(a,2),i=c[0],o=c[1],s(!1),i){e.next=18;break}return console.error(o),L(o),k(!0),e.abrupt("return");case 18:u=g.a.decodeJWT(o.jwt),S("address",o.address,1e3*u.payload.exp),S("privateKey",F,1e3*u.payload.exp),S("jwt",o.jwt,1e3*u.payload.exp),window.location.replace(o.brokerUrl);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(u.jsxs)(f.a,{className:"mt-5",children:[Object(u.jsx)("p",{className:"h4",children:"Please identify yourself:"}),Object(u.jsxs)(h.a,{className:"mt-4",children:[Object(u.jsxs)(h.a.Group,{children:[Object(u.jsx)(h.a.Label,{children:"Private Key:"}),Object(u.jsx)(h.a.Control,{id:"input_privkey",type:"text",placeholder:"Enter your private key",onChange:function(e){return I(e.target.value)}})]}),Object(u.jsxs)(h.a.Group,{children:[Object(u.jsx)(h.a.Label,{children:"Broker Domain:"}),Object(u.jsxs)(x.a,{className:"mb-3",children:[Object(u.jsx)(h.a.Control,{id:"input_ens",placeholder:"ethereum name service (ens)",onChange:function(e){return K(e.target.value)}}),Object(u.jsx)(x.a.Append,{children:Object(u.jsx)(x.a.Text,{children:".eth"})})]})]}),Object(u.jsxs)(i.a,{className:"mt-5",children:[Object(u.jsx)(o.a,{sm:3,children:Object(u.jsxs)(O.a,{variant:"primary",onClick:function(){return M.apply(this,arguments)},children:[c?Object(u.jsx)(v.a,{className:"mr-2",animation:"border",size:"sm"}):null,"Login"]})}),Object(u.jsx)(o.a,{sm:9,children:y?Object(u.jsx)(m.a,{className:"ml-4",variant:"danger",children:T}):null})]})]})]})},P=n(122),D=n.n(P);var F=function(){var e=new D.a(new D.a.providers.WebsocketProvider("ws://192.168.178.24:8545"));return Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)(l,{}),Object(u.jsx)(L,{web3:e})]})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,535)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(528),n(529);s.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(F,{})}),document.getElementById("root")),I()}},[[530,1,2]]]);
//# sourceMappingURL=main.d2717b6b.chunk.js.map